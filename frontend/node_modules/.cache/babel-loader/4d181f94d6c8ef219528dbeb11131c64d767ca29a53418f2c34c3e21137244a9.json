{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/User/Downloads/prog/todo_main/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/User/Downloads/prog/todo_main/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"C:/Users/User/Downloads/prog/todo_main/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nvar _jsxFileName = \"C:\\\\Users\\\\User\\\\Downloads\\\\prog\\\\todo_main\\\\frontend\\\\src\\\\context\\\\AuthContext.js\",\n  _this = this,\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from \"react\";\nimport jwt_decode from \"jwt-decode\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar AuthContext = /*#__PURE__*/createContext();\nexport default AuthContext;\nexport var AuthProvider = function AuthProvider(_ref) {\n  _s();\n  var children = _ref.children;\n  var _useState = useState(function () {\n      return localStorage.getItem(\"authTokens\") ? JSON.parse(localStorage.getItem(\"authTokens\")) : null;\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    authTokens = _useState2[0],\n    setAuthTokens = _useState2[1];\n  var navigate = useNavigate();\n  var _useState3 = useState(function () {\n      return localStorage.getItem(\"authTokens\") ? jwt_decode(localStorage.getItem(\"authTokens\")) : null;\n    }),\n    _useState4 = _slicedToArray(_useState3, 2),\n    user = _useState4[0],\n    setUser = _useState4[1];\n  var _useState5 = useState(true),\n    _useState6 = _slicedToArray(_useState5, 2),\n    loading = _useState6[0],\n    setLoading = _useState6[1];\n\n  // const history = useNavigate();\n\n  var loginUser = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(username, password) {\n      var response, data;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return fetch(\"http://127.0.0.1:8000/auth/token/\", {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\"\n              },\n              body: JSON.stringify({\n                username: username,\n                password: password\n              })\n            });\n          case 2:\n            response = _context.sent;\n            _context.next = 5;\n            return response.json();\n          case 5:\n            data = _context.sent;\n            if (response.status === 200) {\n              setAuthTokens(data);\n              setUser(jwt_decode(data.access));\n              localStorage.setItem(\"authTokens\", JSON.stringify(data));\n              navigate(\"/\");\n            } else {\n              alert(\"Something went wrong!\");\n            }\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n    return function loginUser(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  /**? */\n  var registerUser = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(username, password, password2) {\n      var response;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return fetch(\"http://127.0.0.1:8000/auth/register/\", {\n              method: \"POST\",\n              headers: {\n                \"Content-Type\": \"application/json\"\n              },\n              body: JSON.stringify({\n                username: username,\n                password: password,\n                password2: password2\n              })\n            });\n          case 3:\n            response = _context2.sent;\n            console.log(response);\n            if (response.status === 201) {\n              navigate(\"/login\");\n            } else {\n              alert(\"Something went wrong!\");\n            }\n            _context2.next = 12;\n            break;\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log(_context2.t0);\n            alert(\"Something went wrong!\");\n          case 12:\n          case \"end\":\n            return _context2.stop();\n        }\n      }, _callee2, null, [[0, 8]]);\n    }));\n    return function registerUser(_x3, _x4, _x5) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var logoutUser = function logoutUser() {\n    setAuthTokens(null);\n    setUser(null);\n    localStorage.removeItem(\"authTokens\");\n    navigate(\"/\");\n  };\n  var contextData = {\n    user: user,\n    setUser: setUser,\n    authTokens: authTokens,\n    setAuthTokens: setAuthTokens,\n    registerUser: registerUser,\n    loginUser: loginUser,\n    logoutUser: logoutUser\n  };\n  useEffect(function () {\n    if (authTokens) {\n      setUser(jwt_decode(authTokens.access));\n    }\n    setLoading(false);\n  }, [authTokens, loading]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: contextData,\n    children: loading ? null : children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, _this);\n};\n_s(AuthProvider, \"A2QIo0AzXZGKdpA9GcwSWwR/D3I=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","jwt_decode","useNavigate","jsxDEV","_jsxDEV","AuthContext","AuthProvider","_ref","_s","children","_useState","localStorage","getItem","JSON","parse","_useState2","_slicedToArray","authTokens","setAuthTokens","navigate","_useState3","_useState4","user","setUser","_useState5","_useState6","loading","setLoading","loginUser","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","username","password","response","data","wrap","_callee$","_context","prev","next","fetch","method","headers","body","stringify","sent","json","status","access","setItem","alert","stop","_x","_x2","apply","arguments","registerUser","_ref3","_callee2","password2","_callee2$","_context2","console","log","t0","_x3","_x4","_x5","logoutUser","removeItem","contextData","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_this","_c","$RefreshReg$"],"sources":["C:/Users/User/Downloads/prog/todo_main/frontend/src/context/AuthContext.js"],"sourcesContent":["import React,{ createContext, useState, useEffect } from \"react\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst AuthContext = createContext();\r\n\r\n\r\nexport default AuthContext;\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [authTokens, setAuthTokens] = useState(() =>\r\n    localStorage.getItem(\"authTokens\")\r\n      ? JSON.parse(localStorage.getItem(\"authTokens\"))\r\n      : null\r\n  );\r\n  const navigate = useNavigate();\r\n  const [user, setUser] = useState(() =>\r\n    localStorage.getItem(\"authTokens\")\r\n      ? jwt_decode(localStorage.getItem(\"authTokens\"))\r\n      : null\r\n  );\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // const history = useNavigate();\r\n\r\n  const loginUser = async (username, password) => {\r\n    const response = await fetch(\"http://127.0.0.1:8000/auth/token/\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\"\r\n      },\r\n      body: JSON.stringify({\r\n        username,\r\n        password\r\n      })\r\n    });\r\n    const data = await response.json();\r\n\r\n    if (response.status === 200) {\r\n      setAuthTokens(data);\r\n      setUser(jwt_decode(data.access));\r\n      localStorage.setItem(\"authTokens\", JSON.stringify(data));\r\n      navigate(\"/\");\r\n    } else {\r\n      alert(\"Something went wrong!\");\r\n    }\r\n  };\r\n  /**? */\r\n  const registerUser = async (username, password, password2) => {\r\n    try {\r\n      const response = await fetch(\"http://127.0.0.1:8000/auth/register/\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify({\r\n          username,\r\n          password,\r\n          password2\r\n        })\r\n      });\r\n      console.log(response);\r\n      if (response.status === 201) {\r\n        navigate(\"/login\");\r\n      } else {\r\n        alert(\"Something went wrong!\");\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      alert(\"Something went wrong!\");\r\n    }\r\n  };  \r\n\r\n  const logoutUser = () => {\r\n    setAuthTokens(null);\r\n    setUser(null);\r\n    localStorage.removeItem(\"authTokens\");\r\n    navigate(\"/\");\r\n  };\r\n\r\n  const contextData = {\r\n    user,\r\n    setUser,\r\n    authTokens,\r\n    setAuthTokens,\r\n    registerUser,\r\n    loginUser,\r\n    logoutUser\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (authTokens) {\r\n      setUser(jwt_decode(authTokens.access));\r\n    }\r\n    setLoading(false);\r\n  }, [authTokens, loading]);\r\n\r\n  return (\r\n    <AuthContext.Provider value={contextData}>\r\n      {loading ? null : children}\r\n    </AuthContext.Provider>\r\n  );\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}